<?xml version="1.0" encoding="UTF-8"?> 
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
 	  			xmlns:a="https://ajax4jsf.dev.java.net/ajax"
                xmlns:s="http://jboss.com/products/seam/taglib"
                xmlns:rich="http://richfaces.ajax4jsf.org/rich">

<ui:param name="labelstyle" value="width:150px;" />

<table id="tblfilters" style="border-collapse: collapse;width:100%;"><tr><td>          
   <h2>#{messages['cases.details.addressnotif']}</h2>
	<ui:param name="required" value="false" />

	<s:decorate template="/layout/auselection.xhtml">
		<ui:param name="auselection" value="#{caseFilters.auselection}" />
	</s:decorate>

    <h2>#{messages['cases.healthUnit']}</h2>
	<s:decorate template="/layout/tbselection.xhtml">
		<ui:param name="tbunitselection" value="#{caseFilters.tbunitselection}" />

		<h:selectOneRadio value="#{caseFilters.filterHealthUnit}" >
			<s:selectItems var="v" value="#{filterHealthUnits}" label="#{messages[v.key]}" />
			<s:convertEnum />
		</h:selectOneRadio>
	</s:decorate>

   <h2>#{messages['cases.details.case']}</h2>

	<s:decorate template="/custom/ua/layout/editname.xhtml">
		<ui:define name="label">#{messages['cases.casesearching.patient']}:</ui:define>
		<ui:param name="patientdata" value="#{caseFilters}" />
		<ui:param name="required" value="false" />
	</s:decorate>

	<s:decorate template="/layout/display.xhtml">
		<ui:define name="label">#{messages['Patient.recordNumber']}:</ui:define>
		<h:inputText value="#{caseFilters.recordNumber}" style="width:120px;"></h:inputText>
	</s:decorate>

	<s:decorate template="/layout/display.xhtml" >
		<ui:define name="label">#{messages['CaseClassification']}:</ui:define>
		<h:selectOneMenu value="#{caseFilters.classification}" >
			<s:selectItems value="#{globalLists.caseClassifications}" var="x" label="#{messages[x.key]}" noSelectionLabel="-" />
			<s:convertEnum />
		</h:selectOneMenu>
	</s:decorate>

	<s:decorate template="/layout/display.xhtml">
		<ui:define name="label">#{messages['CaseState']}:</ui:define>
		<h:selectOneMenu value="#{caseFilters.caseState}" >
			<s:selectItems value="#{caseStates}" var="x" label="#{messages[x.key]}" noSelectionLabel="-" />
			<s:convertEnum />
		</h:selectOneMenu>
	</s:decorate>

	<s:decorate template="/layout/display.xhtml">
		<ui:define name="label">#{messages['ValidationState']}:</ui:define>
		<h:selectOneMenu value="#{caseFilters.validationState}" >
			<s:selectItems value="#{globalLists.validationState}" var="x" label="#{messages[x.key]}" noSelectionLabel="-" />
			<s:convertEnum />
		</h:selectOneMenu>
	</s:decorate>

	<s:decorate template="/layout/display.xhtml">
		<ui:define name="label">#{messages['PatientType']}:</ui:define>
		<h:selectOneMenu value="#{caseFilters.patientType}" >
			<s:selectItems value="#{patientTypes}" var="x" label="#{messages[x.key]}" noSelectionLabel="-" />
			<s:convertEnum />
		</h:selectOneMenu>
	</s:decorate>

	<s:decorate template="/custom/ua/layout/infSiteWithTypes.xhtml">
		<ui:param name="infSiteValue" value="#{caseFilters.infectionSite}" />
		<ui:param name="extrapulTypeValue" value="#{caseFiltersUA.extrapulmonaryType}" />
		<ui:param name="extrapulType2Value" value="#{caseFiltersUA.extrapulmonaryType2}" />
		<ui:param name="pulTypeValue" value="#{caseFiltersUA.pulmonaryType}" />
		<ui:param name="withValidate" value="#{false}" />
		<ui:param name="destructAndMBT" value="#{false}" />
	</s:decorate>
	
	<s:decorate template="/layout/display.xhtml">
    	<ui:define name="label">#{messages['Source']}:</ui:define>
		<h:selectOneMenu  value="#{caseFiltersUA.source}" style="width:490px">
			<s:selectItems value="#{sources}" var="x" label="#{x}" noSelectionLabel="-"/>
			<s:convertEntity />
		</h:selectOneMenu>
	</s:decorate>
	
	<s:decorate template="/layout/display.xhtml">
    	<ui:define name="label">#{messages['PrescribedMedicine']}:</ui:define>
		<h:selectOneMenu id="prescribedMedicine" value="#{caseFilters.prescribedMedicine}" style="width:490px">
			<s:selectItems value="#{medicines}" var="x" label="#{x}" noSelectionLabel="-"/>
			<s:convertEntity />
		</h:selectOneMenu>
	</s:decorate>
	
	<!-- VR: To add 'Type of Diagnostic' in the advance search page -->
 	 <s:decorate template="/layout/display.xhtml">
		<ui:define name="label">#{messages['DiagnosisType']}:</ui:define>
		<h:selectOneMenu value="#{caseFilters.diagnosisType}" >
			<s:selectItems value="#{diagnosisTypes}" var="x" label="#{messages[x.key]}" noSelectionLabel="-" />
			<s:convertEnum />
		</h:selectOneMenu>
	</s:decorate>
	
	<s:decorate template="/layout/display.xhtml">
		<ui:define name="label">#{messages['uk_UA.TreatmentType']}:</ui:define>
		<h:selectOneMenu value="#{caseFiltersUA.ttype}" >
			<s:selectItems value="#{globalLists_ua.treatmentTypes}" var="x" label="#{messages[x.key]}" noSelectionLabel="-" />
			<s:convertEnum />
		</h:selectOneMenu>
	</s:decorate>
	
	<s:decorate template="/layout/display.xhtml">
		<ui:define name="label">#{messages['admin.tags']}:</ui:define>
		<h:selectOneMenu value="#{caseFiltersUA.tag}" >
			<s:selectItems value="#{tagsQuery.resultList}" var="x" label="#{x.name}" noSelectionLabel="-" />
			<s:convertEntity/>
		</h:selectOneMenu>
	</s:decorate>
	<!-- End -->
	

   <h2>#{messages['cases.casesearching.filterdates']}</h2>

   <div id="datesdiv" style="padding:6px;">
   	<h:selectBooleanCheckbox value="#{caseFilters.registrationDate}" />#{messages['TbCase.registrationDate']}
   	<h:selectBooleanCheckbox value="#{caseFilters.diagnosisDate}" style="margin-left:20px;" />#{messages['TbCase.diagnosisDate']}
   	<h:selectBooleanCheckbox value="#{caseFilters.iniTreatmentDate}" style="margin-left:20px;" />#{messages['TbCase.iniTreatmentDate']}
   	<h:selectBooleanCheckbox value="#{caseFilters.outcomeDate}" style="margin-left:20px;" />#{messages['TbCase.outcomeDate']}
   </div>

	<div id="perioddiv">
	<s:decorate id="ini" template="/layout/display.xhtml" >
    	<ui:define name="label">#{messages['global.inimonthyear']}:</ui:define>
		<h:selectOneMenu id="inimonth" value="#{caseFilters.iniMonth}" onchange="onChangePeriod()">
			<f:selectItems value="#{months}"/>
		</h:selectOneMenu>
		<h:selectOneMenu id="iniyear" value="#{caseFilters.iniYear}" style="margin-left:10px;" onchange="onChangePeriod()">
			<f:selectItems value="#{years}"/>
		</h:selectOneMenu>
	</s:decorate>

	<s:decorate id="end" template="/layout/display.xhtml" >
    	<ui:define name="label">#{messages['global.endmonthyear']}:</ui:define>
		<h:selectOneMenu id="endmonth" value="#{caseFilters.endMonth}">
			<f:selectItems value="#{months}" onchange="onChangePeriod()"/>
		</h:selectOneMenu>
		<h:selectOneMenu id="endyear" value="#{caseFilters.endYear}" style="margin-left:10px;">
			<f:selectItems value="#{years}" onchange="onChangePeriod()"/>
		</h:selectOneMenu>
	</s:decorate>
	</div>

	<rich:jQuery name="showdates" timing="onJScall" selector="#datesdiv" query="show(500)" />
	<rich:jQuery name="hidedates" timing="onJScall" selector="#datesdiv" query="hide(500)" />
<script type="text/javascript">
function onChangePeriod() {
	vals = mountDateValues();
	ini = vals[0] + vals[1];
	fim = vals[2] + vals[3];
	if ((ini==1)||(fim==1))
		hidedates();
	else showdates();
}
function mountDateValues() {
	index=0;
	var vals=new Array();
	jQuery('#perioddiv select').each(function() {
		vals[index]=this.selectedIndex>0;
		index++;
	});
	return vals;
}
function validateFilters() {
	vals=mountDateValues();
	if (((vals[0]+vals[1])==1)||((vals[2]+vals[3])==1)) {
		alert('#{messages['cases.casesearching.dterror']}');
		return false;
	}
	return true;
}
</script>

</td></tr></table>
    
</ui:composition>
