<?xml version="1.0" encoding="UTF-8"?> 
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
 	  			xmlns:a="https://ajax4jsf.dev.java.net/ajax"
                xmlns:s="http://jboss.com/products/seam/taglib"
                xmlns:rich="http://richfaces.ajax4jsf.org/rich">

<ui:param name="labelstyle" value="width:150px;" />
<h:panelGroup id="pnlfilters">
<table id="tblfilters" style="border-collapse: collapse;width:100%;"><tr><td>
	<s:fragment rendered='#{!casesAZ.notBindedEIDSS}'>          
   <h2>#{messages['cases.details.addressnotif']}</h2>
	<ui:param name="required" value="false" />

	<s:decorate template="/custom/az/layout/auselection.xhtml">
		<ui:param name="auselection" value="#{caseFilters.auselection}" />
	</s:decorate>

    <h2>#{messages['cases.healthUnit']}</h2>
	<s:decorate template="/custom/az/layout/tbselection.xhtml">
		<ui:param name="tbunitselection" value="#{caseFilters.tbunitselection}" />

		<h:selectOneRadio value="#{caseFilters.filterHealthUnit}" >
			<s:selectItems var="v" value="#{filterHealthUnits}" label="#{messages[v.key]}" />
			<s:convertEnum />
		</h:selectOneRadio>
	</s:decorate>
	</s:fragment>
   <h2>#{messages['cases.details.case']}</h2>

	<s:decorate template="/custom/az/layout/editname.xhtml">
		<ui:define name="label">#{messages['cases.casesearching.patient']}:</ui:define>
		<ui:param name="patientdata" value="#{caseFilters}" />
	</s:decorate>
<s:fragment rendered='#{!casesAZ.notBindedEIDSS}'>
	
	<s:decorate template="/layout/display.xhtml">
		<ui:define name="label">#{messages['Patient.caseNumber']}:</ui:define>
		<h:inputText value="#{caseFiltersAZ.caseNums}" style="width:120px;"></h:inputText>
		<br/>
		<h:outputText value="#{messages['filters.range']}" style="font-size:11px;"/>
	</s:decorate>

	<s:decorate template="/layout/display.xhtml" >
		<ui:define name="label">#{messages['CaseClassification']}:</ui:define>
		<h:selectOneMenu value="#{caseFilters.classification}" >
			<s:selectItems value="#{globalLists.caseClassifications}" var="x" label="#{messages[x.key]}" noSelectionLabel="-" />
			<s:convertEnum />
		</h:selectOneMenu>
	</s:decorate>

	<s:decorate template="/layout/display.xhtml">
		<ui:define name="label">#{messages['CaseState']}:</ui:define>
		<h:selectOneMenu value="#{caseFilters.caseState}" >
			<s:selectItems value="#{caseStates}" var="x" label="#{messages[x.key]}" noSelectionLabel="-" />
			<s:convertEnum />
		</h:selectOneMenu>
	</s:decorate>

	<s:decorate template="/layout/display.xhtml">
		<ui:define name="label">#{messages['az_AZ.ValidationState']}:</ui:define>
		<h:selectOneMenu value="#{caseFilters.validationState}" >
			<s:selectItems value="#{globalLists.validationState}" var="x" label="#{messages['az_AZ.'.concat(x.key)]}" noSelectionLabel="-" />
			<s:convertEnum />
		</h:selectOneMenu>
	</s:decorate>

	<s:decorate template="/layout/display.xhtml">
		<ui:define name="label">#{messages['PatientType']}:</ui:define>
		<h:selectOneMenu value="#{caseFilters.patientType}" >
			<s:selectItems value="#{patientTypes}" var="x" label="#{messages[x.key]}" noSelectionLabel="-" />
			<s:convertEnum />
		</h:selectOneMenu>
	</s:decorate>

	<s:decorate template="/layout/display.xhtml">
		<ui:define name="label">#{messages['InfectionSite']}:</ui:define>
		<h:selectOneMenu value="#{caseFilters.infectionSite}" >
			<s:selectItems value="#{infectionSites}" var="x" label="#{messages[x.key]}" noSelectionLabel="-" />
			<s:convertEnum />
		</h:selectOneMenu>
	</s:decorate>
	
	<s:decorate template="/layout/display.xhtml" >
    	<ui:define name="label">#{messages['PrescribedMedicine']}:</ui:define>
		<h:selectOneMenu id="prescribedMedicine" value="#{caseFilters.prescribedMedicine}" style="width:490px">
			<s:selectItems value="#{medicines}" var="x" label="#{x}" noSelectionLabel="-"/>
			<s:convertEntity />
		</h:selectOneMenu>
	</s:decorate>
	
	<!-- VR: To add 'Type of Diagnostic' in the advance search page -->
 	 <s:decorate template="/layout/display.xhtml">
		<ui:define name="label">#{messages['DiagnosisType']}:</ui:define>
		<h:selectOneMenu value="#{caseFilters.diagnosisType}" >
			<s:selectItems value="#{diagnosisTypes}" var="x" label="#{messages[x.key]}" noSelectionLabel="-" />
			<s:convertEnum />
		</h:selectOneMenu>
	</s:decorate>
	</s:fragment>
	<!-- End -->
	<s:decorate template="/layout/display.xhtml">
		<ui:define name="label">#{messages['admin.tags']}:</ui:define>
		<h:selectOneMenu value="#{caseFiltersAZ.tag}" >
			<s:selectItems value="#{tagsQuery.resultList}" var="x" label="#{x.name}" noSelectionLabel="-" />
			<s:convertEntity/>

		</h:selectOneMenu>
	</s:decorate>

   <h2>#{messages['cases.casesearching.filterdates']}</h2>

   <div id="datesdiv" style="padding:6px;">
   	<s:fragment rendered='#{!casesAZ.notBindedEIDSS}'>
   	<div id="usedatepanel">
	   	<h:selectBooleanCheckbox value="#{caseFilters.registrationDate}" onclick="setOffOthers(this);"/>#{messages['TbCase.registrationDate']}
	   	<h:selectBooleanCheckbox value="#{caseFilters.diagnosisDate}" onclick="setOffOthers(this);" style="margin-left:20px;" />#{messages['TbCase.diagnosisDate']}
	   	<h:selectBooleanCheckbox value="#{caseFilters.iniTreatmentDate}" onclick="setOffOthers(this);" style="margin-left:20px;" />#{messages['TbCase.iniTreatmentDate']}
	   	<h:selectBooleanCheckbox value="#{caseFilters.outcomeDate}" onclick="setOffOthers(this);" style="margin-left:20px;" />#{messages['TbCase.outcomeDate']}
   </div>
   </s:fragment>
   </div>

	<div id="perioddiv">
	    	<ui:fragment rendered='#{casesAZ.notBindedEIDSS}' name="label">#{messages['az_EIDSS_REGDATE']}:</ui:fragment>
	<s:decorate id="ini" template="/layout/display.xhtml" >
    	<ui:define name="label">#{messages['global.inimonthyear']}:</ui:define>
		<h:selectOneMenu id="inimonth" value="#{caseFilters.iniMonth}" onchange="onChangePeriod()">
			<f:selectItems value="#{months}"/>
		</h:selectOneMenu>
		<h:selectOneMenu id="iniyear" value="#{caseFilters.iniYear}" style="margin-left:10px;" onchange="onChangePeriod()">
			<f:selectItems value="#{years}"/>
		</h:selectOneMenu>
	</s:decorate>

	<s:decorate id="end" template="/layout/display.xhtml" >
    	<ui:define name="label">#{messages['global.endmonthyear']}:</ui:define>
		<h:selectOneMenu id="endmonth" value="#{caseFilters.endMonth}">
			<f:selectItems value="#{months}" onchange="onChangePeriod()"/>
		</h:selectOneMenu>
		<h:selectOneMenu id="endyear" value="#{caseFilters.endYear}" style="margin-left:10px;">
			<f:selectItems value="#{years}" onchange="onChangePeriod()"/>
		</h:selectOneMenu>
	</s:decorate>
	</div>

	<rich:jQuery name="showdates" timing="onJScall" selector="#datesdiv" query="show(500)" />
	<rich:jQuery name="hidedates" timing="onJScall" selector="#datesdiv" query="hide(500)" />
<script type="text/javascript">
function onChangePeriod() {
	vals = mountDateValues();
	ini = vals[0] + vals[1];
	fim = vals[2] + vals[3];
	if ((ini==1)||(fim==1))
		hidedates();
	else showdates();
}
function mountDateValues() {
	index=0;
	var vals=new Array();
	jQuery('#perioddiv select').each(function() {
		vals[index]=this.selectedIndex>0;
		index++;
	});
	return vals;
}
function validateFilters() {
	vals=mountDateValues();
	if (((vals[0]+vals[1])==1)||((vals[2]+vals[3])==1)) {
		alert('#{messages['cases.casesearching.dterror']}');
		return false;
	}
	return true;
}

function setOffOthers(cb){
	if (cb.checked){
		jQuery("#usedatepanel :checkbox")
			.each(function() { 
			if (this != cb)
				this.checked = false;
			});
		}
}

</script>

</td></tr></table>
</h:panelGroup>
    
</ui:composition>
