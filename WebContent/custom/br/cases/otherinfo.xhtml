<?xml version="1.0" encoding="UTF-8"?> 
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
 	  			xmlns:a="https://ajax4jsf.dev.java.net/ajax"
                xmlns:s="http://jboss.com/products/seam/taglib"
                xmlns:rich="http://richfaces.ajax4jsf.org/rich">

	<div class="spacer" />

	<s:link view="/cases/comorbedt.xhtml" style="float:right;" rendered="#{caseHome.canEditCaseData}" 
		styleClass="button-alt" onclick="disableButton(this)">
		<f:param name="id" value="#{caseHome.id}" />
		<span>#{messages['form.edit']}</span>
	</s:link>
	<h2>#{messages['cases.comorbidities']}</h2>
	<h:outputText value="#{messages['cases.details.noresultfound']}" styleClass="warn" rendered="#{empty tbcase.comorbidities and empty tbcase.patientContactName}" />
	<s:div styleClass="region1" rendered="#{(not empty tbcase.comorbidities) or (not empty tbcase.patientContactName)}">
		<div class="content">
    	<ul>
    	<ui:repeat value="#{tbcase.comorbidities}" var="it">
    		<li>#{it.comorbidity.name}
    			<h:outputText value="(#{it.comment})" rendered="#{not empty it.comment}" style="padding-left:12px;"/>
    		</li>
    	</ui:repeat>
    	</ul>
    	<s:decorate template="/layout/display.xhtml">
    		<ui:param name="labelstyle" value="width:200px" />
    		<ui:define name="label">#{messages['TbCase.tbContact']}:</ui:define>
    		<h:outputText value="#{tbcase.tbContact?messages['global.yes']:messages['global.no']}" /> 
    		<s:fragment rendered="#{not empty tbcase.patientContactName}">
    		<b style="margin-left:30px;">#{messages['TbCase.patientContactName']}:</b> #{tbcase.patientContactName}
    		</s:fragment>
    	</s:decorate>
		</div>
	</s:div>

	<div class="spacer" />

    <s:fragment rendered="#{tbcase.classification!='NMT'}">            
	<s:link view="/custom/br/cases/edtcontact.xhtml" style="float:right;" rendered="#{caseHome.canEditCaseData}" 
		styleClass="button-alt" onclick="disableButton(this)">
		<f:param name="id" value="#{caseHome.id}" />
		<f:param name="conid" value="#{null}" />
		<span>#{messages['form.new']}</span>
	</s:link>
	<h2>#{messages['cases.contacts']}</h2>
	<h:panelGroup id="pnlcontact">
	<h:outputText value="#{messages['cases.details.noresultfound']}" styleClass="warn" rendered="#{empty tbcase.contacts}" />
	
	<s:fragment rendered="#{not empty tbcase.contacts}">
	<a:repeat value="#{tbcase.contacts}" var="it">
	<table class="table1" >
	<tr>
		<td colspan="2" align="left">
			<h:commandLink value="#{messages['form.remove']}" onclick="if (confirm('#{messages['form.confirm_remove']}')) remContact(#{it.id});return false;" 
				style="font-size:9px;float:right;">
			</h:commandLink>
			<s:link styleClass="#{it.gender=='MALE'?'male-icon':'female-icon'}" view="/custom/br/cases/edtcontact.xhtml">
				<f:param name="conid" value="#{it.id}"/>
			</s:link>
			<s:link value="#{it.name}" view="/custom/br/cases/edtcontact.xhtml">
				<f:param name="conid" value="#{it.id}"/>
			</s:link>
			<br />
		 	<h:outputText value="#{messages['Gender']}: #{messages[it.gender.key]}" /> | 
		 	<h:outputText value="#{messages['TbCase.age']}: #{it.age}" /> | 
		 	<h:outputText value="#{messages['TbContact.examined']}: #{it.examinated?messages['global.yes']: messages['global.no']}" />
		</td>
	</tr>
	</table>
	</a:repeat>
	</s:fragment>
	<a:jsFunction name="remContact" action="#{tbContactHome.remove}" reRender="pnlcontact"  rendered="#{caseHome.canEditCaseData}">
		<a:actionparam name="param1" assignTo="#{tbContactHome.id}" converter="javax.faces.Integer"/>
	</a:jsFunction>
	</h:panelGroup>
	</s:fragment>

	<div class="spacer" />

	<s:link view="/cases/sideeffectsedt.xhtml" style="float:right;" rendered="#{caseHome.canEditCaseData}" 
		styleClass="button-alt" onclick="disableButton(this)">
		<f:param name="id" value="#{caseHome.id}" />
		<f:param name="idSideEffect" value="#{null}"/>
		<span>#{messages['form.new']}</span>
	</s:link>
	<h2>#{messages['cases.sideeffects']}</h2>
                 
	<h:panelGroup id="sideeffects">
	<h:outputText value="#{messages['cases.details.noresultfound']}" styleClass="warn" rendered="#{empty sideEffectHome.results}" />
	
	<h:dataTable value="#{sideEffectHome.results}" var="it" styleClass="table1" rowClasses="lin1,lin2" rendered="#{not empty sideEffectHome.results}">
		<h:column>
			<f:facet name="header">
				<h:outputText value="#{messages['cases.sideeffects.desc']}" styleClass="collh" />
			</f:facet>
			<h:outputText value="#{it.sideEffect}" rendered="#{not caseHome.canEditCaseData}"/> 
			<s:link value="#{it.sideEffect}" view="/custom/br/cases/sideeffectsedt.xhtml" propagation="none" style="margin-right:20px;" rendered="#{caseHome.canEditCaseData}">
				<f:param name="id" value="#{tbcase.id}"/>
				<f:param name="idSideEffect" value="#{it.id}"/>
			</s:link>
			<s:fragment rendered="#{not empty it.sideEffect.complement}">
				<div style="display:inline-block">
					 - #{it.sideEffect.complement}
				</div>
			</s:fragment>
			<br />
			<b>#{messages['cases.sideeffects.month']}:</b> #{it.month}
			<br />
			<b><h:outputText value="#{messages['Substance']}:" rendered="#{not empty it.medicines}"/></b> #{it.medicines}
		</h:column>
	
		<h:column>
			<f:facet name="header">
				<h:outputText value="#{messages['global.comments']}" styleClass="collh" />
			</f:facet>
			#{it.comment}
		</h:column>
		
		<h:column>
			<f:facet name="header">
			
			</f:facet>
			<div style="float:right;fonst-size:9px">
				<h:commandLink value="#{messages['form.remove']}"
					onclick="if (confirm('#{messages['form.confirm_remove']}')) remSideEffect(#{it.id});return false;" 
				    rendered="#{caseHome.canEditCaseData}">
				</h:commandLink>
			</div>
		</h:column>
	</h:dataTable>
	
	</h:panelGroup>
	
	<a:jsFunction name="remSideEffect" action="#{sideEffectHome.remove}" reRender="sideeffects"  rendered="#{caseHome.canEditExams}">
		<a:actionparam name="param1" assignTo="#{sideEffectHome.id}" converter="javax.faces.Integer"/>
	</a:jsFunction>
	  

	<s:decorate template="/cases/comments.xhtml">
		<ui:param name="panel" value="other" />
	</s:decorate>
</ui:composition>
