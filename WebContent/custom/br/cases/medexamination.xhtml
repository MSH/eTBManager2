<?xml version="1.0" encoding="UTF-8"?> 
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
 	  			xmlns:a="https://ajax4jsf.dev.java.net/ajax"
                xmlns:s="http://jboss.com/products/seam/taglib"
                xmlns:rich="http://richfaces.ajax4jsf.org/rich">

<ui:param name="labelstyle" value="width:120px;" />

	<h:panelGroup id="medexams">
	<s:link style="float:right;margin-top:6px;" 
		view="/custom/br/cases/edtmedexam.xhtml" 
		styleClass="button-alt" 
		rendered="#{caseHome.canEditCaseData}"
		onclick="disableButton(this)">
		<f:param name="id" value="#{tbcase.id}"/>
		<f:param name="examid" value="#{null}"/>
		<span>#{messages['cases.details.newconsult']}</span>
	</s:link>

	<h:outputText value="#{messages['cases.details.noresultfound']}" styleClass="warn" rendered="#{empty medicalExaminationHome.allResults}" />

	<ui:repeat var="r" value="#{medicalExaminationHome.allResults}">
		<div class="spacer" />

		<div class="region1">
			<div class="header">
			<div style="float:right;">
				<s:link value="#{messages['form.edit']}" view="/custom/br/cases/edtmedexam.xhtml" propagation="none" style="margin-right:20px;" rendered="#{caseHome.canEditCaseData}">
					<f:param name="id" value="#{tbcase.id}"/>
					<f:param name="examid" value="#{r.id}"/>
				</s:link>
				<h:commandLink value="#{messages['form.remove']}" 
					onclick="if (confirm('#{messages['form.confirm_remove']}')) remMedExamination(#{r.id});return false;" 
				    rendered="#{caseHome.canEditCaseData}">
				</h:commandLink>
			</div>
			<h2><h:outputText value="#{r.date}" converter="localeDateConverter" /></h2>
			</div>
			<div class="content">

		<table width="100%" style="border-collapse:collapse;" cellpadding="0" cellspacing="0">
		<tr><td colspan="2">
		<s:decorate template="/layout/display.xhtml" rendered="#{not empty r.nextAppointment}">
    		<ui:define name="label">#{messages['MedicalExaminationBR.nextAppointment']}:</ui:define>
			<h:outputText value="#{r.nextAppointment}" converter="localeDateConverter" />
		</s:decorate>

		<s:decorate template="/layout/display.xhtml" rendered="#{not empty r.clinicalEvolution}">
    		<ui:define name="label">#{messages['pt_BR.ClinicalEvolution']}:</ui:define>
    		#{messages[r.clinicalEvolution.key]}
		</s:decorate>
		
		<s:decorate template="/layout/display.xhtml" rendered="#{not empty r.supervisedTreatment}">
    		<ui:define name="label">#{messages['pt_BR.supervisedTreatment']}:</ui:define>
    		#{messages[r.supervisedTreatment.key]}
		</s:decorate>
		
		<s:decorate template="/layout/display.xhtml" rendered="#{not empty r.supervisionUnitName}">
    		<ui:define name="label">#{messages['pt_BR.supervisionUnit']}:</ui:define>
    		#{r.supervisionUnitName}
		</s:decorate>

	</td></tr>
	<tr><td>
		<s:decorate template="/layout/display.xhtml">
			<ui:define name="label">#{messages['MedicalExamination.surgicalProcedure']}:</ui:define>
			#{messages[r.surgicalProcedure.key]}
		</s:decorate>
	
	</td><td>	
		<s:decorate template="/layout/display.xhtml">
			<ui:define name="label">#{messages['MedicalExamination.surgicalProcedureDesc']}:</ui:define>
			#{r.surgicalProcedureDesc}
		</s:decorate>
		
	</td></tr>
	<tr><td>
		
			<s:decorate template="/layout/display.xhtml">
				<ui:define name="label">#{messages['MedicalExamination.weight']}:</ui:define>
				<h:outputText value="#{r.weight}" >
					<f:convertNumber pattern="#,###,##0.0"/>
				</h:outputText>#{messages['MedicalExamination.weight.unit']}
			</s:decorate>
		</td><td>
			<s:decorate template="/layout/display.xhtml">
				<ui:define name="label">#{messages['MedicalExamination.height']}:</ui:define>
				<h:outputText value="#{r.height}" >
					<f:convertNumber pattern="#,###,##0.00"/>
				</h:outputText>#{messages['MedicalExamination.height.unit']}
			</s:decorate>		
		</td></tr>
		<tr><td colspan="2">
			<s:decorate template="/layout/display.xhtml">
				<ui:define name="label">#{messages['MedicalExamination.BMI']}:</ui:define>
				<h:outputText value="#{r.BMI}" >
					<f:convertNumber pattern="#,###,##0.000"/>
				</h:outputText>
			</s:decorate>		

	</td></tr>
	<tr><td>
		
		<s:decorate template="/layout/display.xhtml" rendered="#{not empty r.responsible}">
    		<ui:define name="label">#{messages['MedicalExamination.responsible']}:</ui:define>
    		#{r.responsible}
		</s:decorate>
	
	</td><td>
	
		<s:decorate template="/layout/display.xhtml" rendered="#{not empty r.positionResponsible}">
    		<ui:define name="label">#{messages['MedicalExamination.positionResponsible']}:</ui:define>
    		#{r.positionResponsible}
		</s:decorate>

	</td></tr>

		<s:fragment rendered="#{not empty r.comments}">
		<tr><td colspan="2">
			<s:decorate template="/layout/display.xhtml">
				<ui:define name="label">#{messages['global.comments']}:</ui:define>
				<h:outputText value="#{r.comments}" escape="false" converter="rmemoria.TextConverter" styleClass="text" />
			</s:decorate>
		</td></tr>
		</s:fragment>
		</table>
			</div>
		</div>	
		
	</ui:repeat>
	</h:panelGroup>

<a:jsFunction name="remMedExamination" action="#{medicalExaminationHome.remove}" reRender="medexams"  rendered="#{caseHome.canEditExams}">
	<a:actionparam name="param1" assignTo="#{medicalExaminationHome.id}" converter="javax.faces.Integer"/>
</a:jsFunction>
    
</ui:composition>
