<?xml version="1.0" encoding="UTF-8"?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:s="http://jboss.com/products/seam/taglib"
      xmlns:rich="http://richfaces.ajax4jsf.org/rich"
      template="/layout/template_new.xhtml">

<ui:param name="title" value="#{messages['meds.receiving']}" />
<ui:param name="topmenu" value="1" />
<ui:param name="labelstyle" value="width:180px;" />
<ui:param name="pagestyle" value="width:700px;" />

<ui:define name="left">
	<div class="vertical-menu">
	<s:link view="/medicines/edtrec.xhtml" value="#{messages['form.edit']}" >
		<f:param name="id" value="#{medicineReceivingHome.id}" />
	</s:link>

    <s:link action="#{medicineReceivingHome.remove}" value="#{messages['form.remove']}" onclick="return confirm('#{messages['form.confirm_remove']}');" >
       	<f:param name="id" value="#{medicineReceivingHome.id}" />
    </s:link>
    </div>
</ui:define>


<ui:define name="naveg">
	<div class="item">
		<s:link value="#{messages['medicines']}" view="/medicines/index.html" propagation="none" />
	</div>
	<div class="item">
		<s:link view="/medicines/receivings.xhtml" value="#{messages['meds.receiving']}" />
	</div>
	<div class="item selected">
		<s:link value="#{title}" />
	</div>
</ui:define>

<ui:define name="print-link">
	<s:link view="/reports/receiving.xhtml" target="_blank" >
		<ui:include src="/layout/print_icon.xhtml" />
		<f:param name="id" value="#{medicineReceiving.id}"/>
	</s:link>
</ui:define>


<ui:define name="content">
<s:decorate template="/layout/unit.xhtml">
<h:form id="main">
    <s:decorate template="/layout/display.xhtml" >
    	<ui:define name="label">#{messages['form.id']}:</ui:define>
    	<h:outputText value="#{medicineReceiving.id}" />
    </s:decorate>

    <s:decorate template="/layout/display.xhtml" >
    	<ui:define name="label">#{messages['Source']}:</ui:define>
    	<h:outputText value="#{medicineReceiving.source.name}" />
    </s:decorate>

    <s:decorate template="/layout/display.xhtml" >
    	<ui:define name="label">#{messages['MedicineReceiving.receivingDate']}:</ui:define>
    	<h:outputText value="#{medicineReceiving.receivingDate}"  converter="localeDateConverter" />
    </s:decorate>

    <s:decorate template="/layout/display.xhtml" >
    	<ui:define name="label">#{messages['global.totalPrice']}:</ui:define>
    	<h:outputText value="#{medicineReceiving.totalPrice}" >
			<f:convertNumber pattern="#,###,##0.00"/>
    	</h:outputText>
    </s:decorate>
	<p/>

	<table width="100%" class="table1" >
		<tr><th><h:outputText value="#{messages['Medicine']}" styleClass="collh" /></th>
				<th><h:outputText value="#{messages['Batch.expiryDate']}" styleClass="colch" /></th>
				<th align="right">#{messages['Batch.numContainers']}</th>
				<th><h:outputText value="#{messages['Batch.quantityReceived']}" styleClass="colrh" /></th>
				<th><h:outputText value="#{messages['global.unitPrice']}" styleClass="colrh" /></th>
				<th><h:outputText value="#{messages['global.totalPrice']}" styleClass="colrh" /></th>
		</tr>
		<ui:repeat value="#{medicineReceiving.medicines}" var="it">
				<tr style="background-color:#F3F8F4;">
					<td colspan="3">
						<div class="medicine-icon">#{it.movement.medicine}</div>
					</td>
					<td class="colr">
						<b>
						<h:outputText value="#{it.movement.quantity}">
							<f:convertNumber pattern="###,###,###"/>
						</h:outputText>
						</b>
					</td>
					<td class="colr">
						<b>
						<h:outputText value="#{it.unitPrice}">
							<f:convertNumber pattern="###,###,##0.0000"/>
						</h:outputText>
						</b>
					</td>
					<td class="colr">
						<b>
						<h:outputText value="#{it.totalPrice}">
							<f:convertNumber pattern="###,###,##0.00"/>
						</h:outputText>
						</b>
					</td>
				</tr>
				<ui:repeat value="#{it.batches}" var="b">
				<tr class="lin2b">
				<td class="colb">
					<div class="batch-icon">
					<span style="width:100px;" >#{messages['Batch.batchNumber']}:</span> #{b.batchNumber}<br/>
					<span style="width:100px;" >#{messages['Batch.manufacturer']}: </span> #{b.manufacturer}<br/>
					<span style="width:100px;" >#{messages['Batch.brandName']}: </span>  #{b.brandName}
					</div>
				</td>
				<td class="colcb">
					<h:outputText value="#{b.expiryDate}" converter="localeDateConverter" />
				</td>
				<td class="colrb">
					<h:outputText value="#{b.numContainers}" >
						<f:convertNumber pattern="#,###,##0"/>
					</h:outputText>
					<h:outputText value="(#{b.quantityContainer})" style="margin-left:5px;">
						<f:convertNumber pattern="#,###,##0"/>
					</h:outputText>
				</td>
				<td class="colrb">
					<h:outputText value="#{b.quantityReceived}"><f:convertNumber pattern="###,###,###"/></h:outputText>
				</td>
				<td class="colrb">
					<h:outputText value="#{b.unitPrice}">
									<f:convertNumber pattern="#,###,##0.0000"/>
								</h:outputText>
				</td>
				<td class="colrb">
					<h:outputText value="#{b.totalPrice}">
						<f:convertNumber pattern="#,###,##0.00"/>
					</h:outputText>
				</td>
				</tr>
				</ui:repeat>
		</ui:repeat>
		<tr><th colspan="5" align="left">
				<b>#{messages['global.totalPrice']}</b>
		</th>
		<th align="right">
			<h:outputText value="#{medicineReceiving.totalPrice}" >
					<f:convertNumber pattern="#,###,##0.00"/>
   			</h:outputText>
		</th></tr>
	</table>
</h:form>
</s:decorate>

</ui:define>

</ui:composition>