<?xml version="1.0" encoding="UTF-8"?> 
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
 	  			xmlns:a="https://ajax4jsf.dev.java.net/ajax"
                xmlns:s="http://jboss.com/products/seam/taglib"
                xmlns:rich="http://richfaces.ajax4jsf.org/rich">

	<h:panelGroup id="#{panel}pnlComments" >
	<s:decorate template="/layout/roundrect.xhtml" style="margin:4px;margin-top:10px;" 
		rendered="#{caseCommentsHome.displayComments}">

		<ui:define name="header">
			<b>#{messages['global.comments']}</b>
			<br/>
			<table width="100%"><tr><td>
			<s:fragment rendered="#{s:hasRole('CASE_COMMENTS')}">
				<h:inputTextarea value="#{caseComment.comment}" style="width:500px;height:50px;float:left;"/>
				<a:commandButton value="#{messages['cases.comments.add']}" style="width:200px" 
					styleClass="button" 
					action="#{caseCommentsHome.addComment}" 
					reRender="#{panel}pnlComments"/>
			</s:fragment>
			</td></tr>
			</table>
		</ui:define>
		<ui:param name="showfooter" value="0" />

		
		<h:dataTable value="#{caseCommentsHome.comments}" var="it" >
			<h:column >
				<div style="width:100%;background-color:#ededed;padding:4px;">
				<b>#{it.caseComment.user.name}</b>
				<br/>
				<h:outputText value="#{it.caseComment.date}" converter="localeDateConverter"/>
				<h:outputText value="#{it.caseComment.date}" style="margin-left:8px;">
					<s:convertDateTime type="time" timeZone="#{timezones.default}"/>
				</h:outputText>
				</div>
			</h:column>

			<h:column >
				<div style="padding-left:10px">
				<h:outputText value="#{it.caseComment.comment}" 
					escape="false" converter="rmemoria.TextConverter"
					styleClass="text" />
				<a:commandLink value="#{messages['form.remove']}"
					action="#{caseCommentsHome.remove}" 
					reRender="#{panel}pnlComments,messages"
					style="display:table;margin-bottom:10px;"
					styleClass="small-link" 
					rendered="#{it.canRemove}">
					<a:actionparam name="param1" value="#{it.caseComment.id}" 
						assignTo="#{caseCommentsHome.id}" 
						converter="javax.faces.Integer" />
				</a:commandLink>
				</div>
			</h:column>
			
		</h:dataTable>
		
	</s:decorate>    

	</h:panelGroup>
</ui:composition>
