<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
				xmlns:h="http://java.sun.com/jsf/html"
				xmlns:ui="http://java.sun.com/jsf/facelets"
				xmlns:rich="http://richfaces.ajax4jsf.org/rich"
				xmlns:s="http://jboss.com/products/seam/taglib"
				xmlns:a="https://ajax4jsf.dev.java.net/ajax"
				template="/layout/templatepub.xhtml">

<ui:param name="title" value="#{messages['mdrtb_system']}"/>

<ui:define name="content">

<s:decorate template="/layout/wrong_browser.xhtml" rendered="#{not browserInfo.validBrowser}" />
<s:fragment rendered="#{browserInfo.validBrowser}">
<h:panelGroup id="loginpanel" >

	<div id="msgdiv" class="container login-container" style="#{etbmanagerApp.countryCode == 'BD' ? 'display:block' : 'display:none'}">
		<h3>INVITATION</h3>
		<h4>e-TB Manager anonymous user satisfaction <a href="https://www.surveygizmo.com/s3/2319377/Bangladesh">survey</a></h4>
		<h5><b>It takes only 5 to 10 minutes!</b></h5>
		<p>If you have not yet completed the anonymous e-TB Manager survey, please click this link:
			<a href="https://www.surveygizmo.com/s3/2319377/Bangladesh">https://www.surveygizmo.com/s3/2319377/Bangladesh</a>
		</p>
		<p>Every user has to complete the survey, even if sharing the same login/password or sharing the same computer in the health facility.</p>
		<p>Do not forget to click the button submit at the end of the survey to make your responses valid.</p>
		<p>Your feedback will greatly help the NTP and partners better guide the planned expansion of e-TB Manager to more health facilities in Bangladesh.</p>
		<h4>THANK YOU!</h4>
		<hr/>
		<a href="#" onClick="gotologin()">If you already completed the survey - thank you! Click here to go to login page.</a>
	</div>


	<div id="logindiv" class="container login-container" style="#{etbmanagerApp.countryCode == 'BD' ? 'display:none' : 'display:block'}">
	<h4>#{messages['login.msg1']}</h4>
	<h:form id="main" role="form" styleClass="form-horizontal">
	<h:panelGroup id="msg">
	<s:div rendered="#{not empty facesMessages.currentMessages}" styleClass="alert alert-danger">
	<h:messages layout="list" />
	</s:div>
	</h:panelGroup>
		<div class="form-group">
			<label for="user" class="col-sm-4 control-label">#{messages['login.user_login']}:</label>
			<div class="input-group col-sm-5">
				<span class="input-group-addon"><i class="icon-user" /></span>
				<h:inputText id="user" value="#{credentials.username}" styleClass="form-control" />
			</div>
		</div>
		<div class="form-group">
			<label class="col-sm-4 control-label" for="pwd">#{messages['User.password']}:</label>
			<div class="input-group col-sm-5">
				<span class="input-group-addon"><i class="icon-key" /></span>
				<h:inputSecret id="pwd" value="#{credentials.password}" styleClass="form-control"/>
			</div>
		</div>
		<div class="form-group">
			<div class="col-sm-offset-4">
				<div class="input-group col-sm-7">
					<label class="checkbox">
						<h:selectBooleanCheckbox id="rememberMe" value="#{rememberMe.enabled}"/>#{messages['login.rememberme']}
					</label>
				</div>
			</div>
		</div>
	<div class="form-group">
		<div class="col-sm-offset-4">
    	<div class="input-group col-sm-7 col-xs-12">
	       	<a:commandButton id="btnOk" styleClass="btn btn-primary btn-block" onclick="callLogin(); return false;" value="#{messages['login.enter']}" />
			<rich:jQuery timing="onload" selector="#nome" query="focus()" />
			<rich:hotKey selector="input" key="return" handler="callLogin();" />
			<a:jsFunction id="login" name="callLogin" ajaxSingle="false" action="#{identity.login}" reRender="main:msg" /> 
  		</div>
  		</div>
  	</div>
	</h:form>
	<hr/>
		<h4>#{messages['login.msg2']}</h4>
		<s:link view="/sendpassword.xhtml" value="#{messages['login.click_here']}" />
		<s:fragment rendered="#{etbmanagerApp.configuration.allowRegPage}">
			<h4>#{messages['login.newuser']}</h4>
			<s:link view="/newuser.xhtml" value="#{messages['login.click_here']}" />
		</s:fragment>

</div>



<ui:include src="/layout/waitdlg.xhtml" />
<a:status onstart="openWaitDlg();" onstop="closeWaitDlg();"></a:status>

<script type="text/javascript">
<!--
function gotologin(){
	document.getElementById("msgdiv").style.display = 'none';
	document.getElementById("logindiv").style.display = 'block';
}
-->
</script>
 
</h:panelGroup>
</s:fragment>

</ui:define>

</ui:composition>