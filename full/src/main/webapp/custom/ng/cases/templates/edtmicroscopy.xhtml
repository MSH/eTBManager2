<?xml version="1.0" encoding="UTF-8"?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:s="http://jboss.com/products/seam/taglib"
      xmlns:a="https://ajax4jsf.dev.java.net/ajax"
      xmlns:rich="http://richfaces.ajax4jsf.org/rich">

	<s:decorate template="/layout/edit.xhtml" >
		<ui:define name="label">#{messages['cases.details.result']}:</ui:define>
		<ui:param name="redasterisk" value="#{true}" />
		<h:selectOneMenu id="micres" value="#{microscopyActions.instance.result}" onchange="micResultChanged(this);">
			<s:selectItems value="#{microscopyResults}" var="it" noSelectionLabel="#{messages['global.notdone']}" label="#{messages[it.key]}" />
			<s:convertEnum />
		</h:selectOneMenu>
	</s:decorate>

	<rich:jQuery selector="#micres" query="change( function(){ examResultChanged(this, 'micdata'); })" />

	<div id="micdata" style="#{empty microscopyActions.instance.result? 'display:none': ''}">
		<s:decorate template="/custom/ng/cases/edtsample.xhtml">
			<ui:param name="examHome" value="#{microscopyActions}" />
			<ui:param name="redasteriskforreq" value="true"/>
			<ui:param name="ctrlprefix" value="mic"/>
			<ui:param name="hideSampleNumber" value="true" />
			<ui:param name="hideLaboratory" value="true" />
		</s:decorate>

		<div class="paragraph">#{messages['cases.exams.results']}</div>
		<s:decorate template="/layout/dateedit.xhtml" >
			<ui:define name="label">#{messages['cases.exams.dateRelease']}:</ui:define>
			<ui:param name="future" value="false" />
			<ui:param name="datefield" value="#{microscopyActions.instance.dateRelease}" />
			<ui:param name="edtid" value="micdtrelease"/>
			<ui:param name="required" value="false" />
		</s:decorate>

		<div id="divmicafb">
			<s:decorate template="/layout/edit.xhtml" >
				<ui:define name="label">#{messages['ExamMicroscopy.numberSamplesCollected']}:</ui:define>
				<h:selectOneMenu id="micafb" value="#{microscopyActions.instance.numberSamplesCollected}" >
					<f:selectItems value="#{microscopyActions.optionsNumSamples}" />
				</h:selectOneMenu>
			</s:decorate>
		</div>

		<s:decorate template="/layout/edit.xhtml" >
			<ui:define name="label">#{messages['global.comments']}:</ui:define>
			<h:inputText id="miccomments" value="#{microscopyActions.instance.comments}" maxlength="200" style="width:350px;"/>
		</s:decorate>
	</div>

	<script type="text/javascript">
		function micResultChanged(cb, immediate) {
			var s = cb.options[cb.selectedIndex].value;
			if (s=='POSITIVE')
				jQuery('#divmicafb').show(immediate?0:500)
			else jQuery('#divmicafb').hide(immediate?0:500);
		}
	</script>

</ui:composition>  
