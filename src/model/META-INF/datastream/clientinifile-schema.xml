<?xml version="1.0" encoding="UTF-8"?>
<graphSchema xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="datastream-1.0.xsd">

    <objectCollection name="dataset">

        <objectGraph name="system" class="org.msh.tb.sync.ServerSignature" />
        
        <objectGraph name="workspace" class="org.msh.tb.entities.Workspace">
            <property name="id" xmlAttribute="true" use="REQUIRED" />
            <property name="name.name1" elementName="name1" use="REQUIRED" />
            <property name="name.name2" elementName="name2" />
            <property name="view" use="IGNORE" />
            <property name="users" use="IGNORE" />
            <property name="createTransaction" use="IGNORE" />
            <property name="lastTransaction" use="IGNORE" />
            <property name="expiredMedicineAdjustmentType" use="IGNORE" />
        </objectGraph>
        
        <objectGraph name="version" class="org.msh.tb.sync.EntityLastVersion">
        </objectGraph>

        <objectGraph name="userprofile" class="org.msh.tb.entities.UserProfile">
            <property name="id" xmlAttribute="true" use="REQUIRED" />
            <property name="permissions">
                <objectGraph name="permission" class="org.msh.tb.entities.UserPermission" parentProperty="userProfile">
                    <property name="userRole.id" elementName="role_id" use="REQUIRED" xmlAttribute="true"/>
                    <property name="id" use="REQUIRED" xmlAttribute="true"/>
                    <property name="canChange" use="REQUIRED" xmlAttribute="true"/>
                    <property name="canExecute" use="REQUIRED" xmlAttribute="true"/>
                    <property name="grantPermission" elementName="grant" use="REQUIRED" xmlAttribute="true"/>
                    <property name="caseClassification" elementName="classif" xmlAttribute="true"/>
                </objectGraph>
            </property>
            <property name="createTransaction" use="IGNORE" />
            <property name="lastTransaction" use="IGNORE" />
            <property name="workspace" use="IGNORE" />
        </objectGraph>

        <objectGraph name="countrystructure" class="org.msh.tb.entities.CountryStructure">
            <property name="id" xmlAttribute="true" use="REQUIRED" />
            <property name="level" xmlAttribute="true" use="REQUIRED" />
            <property name="name.name1" elementName="name1" xmlAttribute="true" use="REQUIRED" />
            <property name="name.name2" elementName="name2" xmlAttribute="true" use="REQUIRED" />
            <property name="createTransaction" use="IGNORE" />
            <property name="lastTransaction" use="IGNORE" />
            <property name="workspace" use="IGNORE" />
        </objectGraph>
        
        <objectGraph name="adminunit" class="org.msh.tb.entities.AdministrativeUnit">
            <property name="id" xmlAttribute="true" use="REQUIRED" />
            <property name="name.name1" elementName="name1" use="REQUIRED" xmlAttribute="true"/>
            <property name="name.name2" elementName="name2" xmlAttribute="true"/>
            <property name="countryStructure.id" elementName="struct" use="REQUIRED" xmlAttribute="true" />
            <property name="code" xmlAttribute="true" use="REQUIRED" />
            <property name="legacyId" xmlAttribute="true" />
            <property name="parent.id" elementName="parent_id" xmlAttribute="true" />
            <property name="unitsCount" xmlAttribute="true" />
            <property name="units" use="IGNORE" />
            <property name="createTransaction" use="IGNORE" />
            <property name="lastTransaction" use="IGNORE" />
            <property name="workspace" use="IGNORE" />
        </objectGraph>
        
        <objectGraph name="healthsys" class="org.msh.tb.entities.HealthSystem">
            <property name="id" xmlAttribute="true" use="REQUIRED" />
            <property name="name.name1" elementName="name1" use="REQUIRED" />
            <property name="name.name2" elementName="name2" />
            <property name="legacyId" xmlAttribute="true" />
            <property name="createTransaction" use="IGNORE" />
            <property name="lastTransaction" use="IGNORE" />
            <property name="workspace" use="IGNORE" />
        </objectGraph>
        
        <objectGraph name="source" class="org.msh.tb.entities.Source">
            <property name="id" xmlAttribute="true" use="REQUIRED" />
            <property name="name.name1" elementName="name1" use="REQUIRED" />
            <property name="name.name2" elementName="name2" />
            <property name="abbrevName.name1" elementName="abbrevname1" use="REQUIRED" />
            <property name="abbrevName.name2" elementName="abbrevname2" />
            <property name="legacyId" xmlAttribute="true" />
            <property name="createTransaction" use="IGNORE" />
            <property name="lastTransaction" use="IGNORE" />
            <property name="workspace" use="IGNORE" />
        </objectGraph>
        
        <objectGraph name="tbunit" class="org.msh.tb.entities.Tbunit">
            <property name="id" xmlAttribute="true" use="REQUIRED" />
            <property name="name.name1" elementName="name1" use="REQUIRED" />
            <property name="name.name2" elementName="name2" />
            <property name="adminUnit.id" elementName="adminunit" />
            <property name="firstLineSupplier.id" elementName="firstlinesupplier" use="IGNORE"/>
            <property name="secondLineSupplier.id" elementName="secondlinesupplier" use="IGNORE"/>
            <property name="authorizerUnit.id" elementName="authorizer" use="IGNORE"/>
            <property name="healthSystem.id" elementName="healthSystem" />
            <property name="legacyId" xmlAttribute="true" />
            <property name="createTransaction" use="IGNORE" />
            <property name="lastTransaction" use="IGNORE" />
            <property name="workspace" use="IGNORE" />
        </objectGraph>
        
        <objectGraph name="unit-link" class="org.msh.tb.sync.TBUnitLinks">
        </objectGraph>
        
        <objectGraph name="substance" class="org.msh.tb.entities.Substance">
            <property name="id" xmlAttribute="true" use="REQUIRED" />
            <property name="name.name1" elementName="name1" use="REQUIRED" />
            <property name="name.name2" elementName="name2" />
            <property name="abbrevName.name1" elementName="abbrevname1" use="REQUIRED" />
            <property name="abbrevName.name2" elementName="abbrevname2" />
            <property name="legacyId" xmlAttribute="true" />
            <property name="createTransaction" use="IGNORE" />
            <property name="lastTransaction" use="IGNORE" />
            <property name="workspace" use="IGNORE" />
        </objectGraph>
        
        <objectGraph name="medicine" class="org.msh.tb.entities.Medicine">
            <property name="id" xmlAttribute="true" use="REQUIRED" />
            <property name="genericName.name1" elementName="name1" use="REQUIRED" />
            <property name="genericName.name2" elementName="name2" />
            <property name="abbrevName" elementName="abbrevname" use="REQUIRED" />
            <property name="components">
                <objectGraph name="component" class="org.msh.tb.entities.MedicineComponent" parentProperty="medicine">
                    <property name="id" xmlAttribute="true" />
                    <property name="substance.id" elementName="substance" xmlAttribute="true" />
                    <property name="strength" xmlAttribute="true" />
                </objectGraph>
            </property>
            <property name="legacyId" xmlAttribute="true" />
            <property name="group" use="IGNORE" />
            <property name="createTransaction" use="IGNORE" />
            <property name="lastTransaction" use="IGNORE" />
            <property name="workspace" use="IGNORE" />
        </objectGraph>
        
        <objectGraph name="lab" class="org.msh.tb.entities.Laboratory">
            <property name="id" xmlAttribute="true" use="REQUIRED" />
            <property name="name" elementName="name" use="REQUIRED" />
            <property name="abbrevName" elementName="abbrevName" use="REQUIRED"/>
            <property name="adminUnit.id" elementName="adminunit" />
            <property name="healthSystem.id" elementName="healthsystem" />
            <property name="legacyId" xmlAttribute="true" />
            <property name="createTransaction" use="IGNORE" />
            <property name="lastTransaction" use="IGNORE" />
            <property name="workspace" use="IGNORE" />
        </objectGraph>
        
        <objectGraph name="field" class="org.msh.tb.entities.FieldValue">
            <property name="id" xmlAttribute="true" use="REQUIRED" />
            <property name="name.name1" elementName="name1" use="REQUIRED" />
            <property name="name.name2" elementName="name2" />
            <property name="shortName.name1" elementName="shortname1" use="REQUIRED" />
            <property name="shortName.name2" elementName="shortname2" />
            <property name="field" xmlAttribute="true" />
            <property name="other" xmlAttribute="true" />
            <property name="displayOrder" xmlAttribute="true" />
            <property name="customId" xmlAttribute="true" />
            <property name="createTransaction" use="IGNORE" />
            <property name="lastTransaction" use="IGNORE" />
            <property name="workspace" use="IGNORE" />
        </objectGraph>

        <!-- TREATMENT REGIMEN -->
        <objectGraph name="regimen" class="org.msh.tb.entities.Regimen">
            <property name="id" xmlAttribute="true" use="REQUIRED" />
            <property name="medicines">
                <objectGraph name="medicine" class="org.msh.tb.entities.MedicineRegimen">
                    <property name="id" xmlAttribute="true" />
                    <property name="medicine.id" elementName="medicine" />
                    <property name="defaultSource.id" elementName="source" />
                </objectGraph>
            </property>
            <property name="createTransaction" use="IGNORE" />
            <property name="lastTransaction" use="IGNORE" />
            <property name="workspace" use="IGNORE" />
        </objectGraph>
        
		<!-- USERS -->
        <objectGraph name="userws" class="org.msh.tb.entities.UserWorkspace">
            <property name="id" xmlAttribute="true" use="REQUIRED" />
            <property name="healthSystem.id" elementName="healthsystem" xmlAttribute="true" />
            <property name="tbunit.id" elementName="tbunit" xmlAttribute="true" />
            <property name="profile.id" elementName="profile" xmlAttribute="true" />
            <property name="adminUnit.id" elementName="adminunit" xmlAttribute="true" />
            <property name="user">
                <objectGraph name="user" class="org.msh.tb.entities.User">
            		<property name="id" xmlAttribute="true" use="REQUIRED" />
            		<property name="login" xmlAttribute="true" use="REQUIRED" />
            		<property name="parentUser.id" use="IGNORE"/>
            		<property name="defaultWorkspace" use="IGNORE" />
            		<property name="workspaces" use="IGNORE" />
            		<property name="theme" use="IGNORE" />
                </objectGraph>
            </property>
            <property name="workspace" use="IGNORE" />
        </objectGraph>

        
        <!-- TB CASES -->
        <objectGraph name="tbcase" class="org.msh.tb.entities.TbCase">
            <property name="id" xmlAttribute="true" use="REQUIRED" />
            <property name="version" use="IGNORE" />
            <property name="patient" >
                <objectGraph name="patient" class="org.msh.tb.entities.Patient">
            		<property name="id" xmlAttribute="true" use="REQUIRED" />
            		<property name="cases" use="IGNORE" />
            		<property name="createTransaction" use="IGNORE" />
		            <property name="lastTransaction" use="IGNORE" />
            		<property name="workspace" use="IGNORE" />
            	</objectGraph>
            </property>
            <property name="classification" xmlAttribute="true" />
            <property name="state" xmlAttribute="true" />
            <property name="patientType" xmlAttribute="true" />
            <property name="diagnosisType" xmlAttribute="true" />
            <property name="infectionSite" xmlAttribute="true" />
            <property name="treatmentPeriod.iniDate" elementName="iniTreatDate"/>
            <property name="treatmentPeriod.endDate" elementName="endTreatDate"/>
            <property name="regimen.id" elementName="regimen" />
            <property name="regimenIni.id" elementName="regimenini" />
            <property name="ownerUnit.id" elementName="ownerunit" xmlAttribute="true"/>
            <property name="pulmonaryType.id" elementName="pulmonaryType" />
            <property name="extrapulmonaryType.id" elementName="extrapulmonaryType" />
            <property name="extrapulmonaryType2.id" elementName="extrapulmonaryType2" />
            <property name="notificationUnit.id" elementName="notificationUnit" />
            <property name="healthUnits" use="IGNORE" />
            <property name="prescribedMedicines" use="IGNORE" />
            <property name="sideEffects" use="IGNORE" />
            <property name="comorbidities" use="IGNORE" />
            <property name="examinations" use="IGNORE" />
            <property name="resXRay" use="IGNORE" />
            <property name="contacts" use="IGNORE" />
            <property name="dispensing" use="IGNORE" />
            <property name="resHIV" use="IGNORE" />
            <property name="examsCulture" use="IGNORE" />
            <property name="examsMicroscopy" use="IGNORE" />
            <property name="examsDST" use="IGNORE" />
        	<property name="createTransaction" use="IGNORE" />
		    <property name="lastTransaction" use="IGNORE" />
            <property name="tags" use="IGNORE" />
        </objectGraph>
        
        <objectGraph name="examdst" class="org.msh.tb.entities.ExamDST">
            <property name="id" xmlAttribute="true" use="REQUIRED"/>
            <property name="tbcase.id" elementName="tbcase" use="REQUIRED" xmlAttribute="true" />
            <property name="dateCollected" xmlAttribute="true" />
            <property name="numResistant" use="IGNORE" />
            <property name="numContaminated" use="IGNORE" />
            <property name="numSusceptible" use="IGNORE" />
            <property name="results" use="IGNORE" />
            <property name="laboratory.id" elementName="lab" xmlAttribute="true"/>
            <property name="method.id" elementName="method" xmlAttribute="true"/>
            <property name="createTransaction" use="IGNORE" />
		    <property name="lastTransaction" use="IGNORE" />
        </objectGraph>
        
        <objectGraph name="dstresult" class="org.msh.tb.entities.ExamDSTResult">
            <property name="id" xmlAttribute="true" use="REQUIRED"/>
            <property name="exam.id" elementName="exam" xmlAttribute="true" />
            <property name="substance.id" elementName="substance" use="REQUIRED" xmlAttribute="true"/>
            <property name="result" use="REQUIRED" xmlAttribute="true"/>
        </objectGraph>
        
        <objectGraph name="exammicroscopy" class="org.msh.tb.entities.ExamMicroscopy">
            <property name="id" xmlAttribute="true" use="REQUIRED"/>
            <property name="tbcase.id" elementName="tbcase" use="REQUIRED" xmlAttribute="true" />
            <property name="result" xmlAttribute="true" />
            <property name="dateCollected" xmlAttribute="true" />
            <property name="laboratory.id" elementName="lab" xmlAttribute="true"/>
            <property name="method.id" elementName="method" xmlAttribute="true"/>
            <property name="createTransaction" use="IGNORE" />
		    <property name="lastTransaction" use="IGNORE" />
        </objectGraph>
        
        <objectGraph name="examculture" class="org.msh.tb.entities.ExamCulture" >
            <property name="id" xmlAttribute="true" use="REQUIRED"/>
            <property name="tbcase.id" elementName="tbcase" use="REQUIRED" xmlAttribute="true" />
            <property name="dateCollected" xmlAttribute="true" />
            <property name="result" xmlAttribute="true" />
            <property name="laboratory.id" elementName="lab" xmlAttribute="true"/>
            <property name="method.id" elementName="method" xmlAttribute="true"/>
            <property name="createTransaction" use="IGNORE" />
		    <property name="lastTransaction" use="IGNORE" />
        </objectGraph>
        
        <objectGraph name="examhiv" class="org.msh.tb.entities.ExamHIV">
            <property name="id" xmlAttribute="true" use="REQUIRED"/>
            <property name="tbcase.id" elementName="tbcase" use="REQUIRED" xmlAttribute="true" />
            <property name="result" xmlAttribute="true" />
        </objectGraph>
        
        <objectGraph name="caseDispensing" class="org.msh.tb.entities.CaseDispensing" >
            <property name="id" xmlAttribute="true" use="REQUIRED"/>
            <property name="tbcase.id" elementName="tbcase" use="REQUIRED" xmlAttribute="true" />
            <property name="dispensingDays">
                 <objectGraph name="caseDispDays" class="org.msh.tb.entities.CaseDispensingDays" parentProperty="caseDispensing">
                 </objectGraph>
            </property>
        </objectGraph>
        
        <objectGraph name="healthunit" class="org.msh.tb.entities.TreatmentHealthUnit" >
            <property name="id" xmlAttribute="true" use="REQUIRED"/>
            <property name="tbcase.id" elementName="tbcase" use="REQUIRED" xmlAttribute="true" />
            <property name="tbunit.id" elementName="tbunit" use="REQUIRED" xmlAttribute="true"/>
            <property name="transferring" elementName="transf" xmlAttribute="true" />
            <property name="period.iniDate" elementName="iniDate" use="REQUIRED" />
            <property name="period.endDate" elementName="endDate" use="REQUIRED" />
        </objectGraph>
        
        <objectGraph name="presc-med" class="org.msh.tb.entities.PrescribedMedicine" >
            <property name="id" xmlAttribute="true" use="REQUIRED"/>
            <property name="tbcase.id" elementName="tbcase" use="REQUIRED" xmlAttribute="true" />
            <property name="medicine.id" elementName="medicine" use="REQUIRED" xmlAttribute="true"/>
            <property name="period.iniDate" elementName="iniDate" use="REQUIRED" />
            <property name="period.endDate" elementName="endDate" use="REQUIRED" xmlAttribute="true"/>
            <property name="source.id" elementName="source" use="REQUIRED" />
            <property name="doseUnit" use="REQUIRED" xmlAttribute="true"/>
            <property name="frequency" use="REQUIRED" xmlAttribute="true"/>
        </objectGraph>
        
        <objectGraph name="address" class="org.msh.tb.entities.Address">
            <property name="adminUnit.id" elementName="adminunit" />
        </objectGraph>
        
        <objectGraph name="contact" class="org.msh.tb.entities.TbContact" >
            <property name="id" xmlAttribute="true" use="REQUIRED"/>
            <property name="tbcase.id" elementName="tbcase" use="REQUIRED" xmlAttribute="true" />
            <property name="contactType.id" elementName="contactType" />
            <property name="conduct.id" elementName="conduct" />
        </objectGraph>
        
        <objectGraph name="examxray" class="org.msh.tb.entities.ExamXRay">
            <property name="id" xmlAttribute="true" use="REQUIRED"/>
            <property name="tbcase.id" elementName="tbcase" use="REQUIRED" xmlAttribute="true" />
            <property name="presentation.id" elementName="presentation" />
        </objectGraph>
        
        <objectGraph name="medexam" class="org.msh.tb.entities.MedicalExamination" >
            <property name="id" xmlAttribute="true" use="REQUIRED"/>
            <property name="tbcase.id" elementName="tbcase" use="REQUIRED" xmlAttribute="true" />
        </objectGraph>
        
        <objectGraph name="sideEffect" class="org.msh.tb.entities.CaseSideEffect" >
        	<property name="id" xmlAttribute="true" use="REQUIRED"/>
            <property name="tbcase.id" elementName="tbcase" use="REQUIRED" xmlAttribute="true" />
            <property name="sideEffect.value.id" elementName="sideeffect" xmlAttribute="true"/>
            <property name="sideEffect.complement" elementName="complement" />
            <property name="substance.id" elementName="substance" />
            <property name="substance2.id" elementName="substance2" />
        </objectGraph>

        <objectGraph name="comorbidity" class="org.msh.tb.entities.CaseComorbidity" >
        	<property name="id" xmlAttribute="true" use="REQUIRED"/>
            <property name="tbcase.id" elementName="tbcase" use="REQUIRED" xmlAttribute="true" />
        	<property name="comorbidity.id" elementName="comorbidity" use="REQUIRED" xmlAttribute="true"/>
        	<property name="duration" xmlAttribute="true" />
            <property name="comorb" use="IGNORE" />
        </objectGraph>
        
    </objectCollection>
</graphSchema>
